from pyspark import SparkConf
from pyspark.sql import *

if __name__ == '__main__':
    # print("======1:" + str(time.asctime(time.localtime(time.time()))))
    conf = SparkConf().setAppName('cjh')
    # conf.set("sparkcjh.driver.memory", "8g")
    # conf.set("sparkcjh.executor.memory", "8g")
    # conf.set("sparkcjh.driver.memory", "2g")
    # conf.set("sparkcjh.executor.memory", "8g")
    # conf.set("sparkcjh.num.executors", "3")
    # conf.set("sparkcjh.executor.core", "3")
    # conf.set("sparkcjh.default.parallelism", "20")
    # conf.set("sparkcjh.memory.fraction", "0.75")
    # conf.set("sparkcjh.memory.storageFraction", "0.75")
    conf.set("spark.scheduler.mode", "FIFO")
    spark = SparkSession.builder.config(conf=conf).getOrCreate()
    HDFS_ST_PLACE = 'hdfs://43.58.5.249:8020/co_ap_list/1600711202'
    df_pla_old = spark.read.parquet(HDFS_ST_PLACE)
    df = spark.read.jdbc(url="jdbc:postgresql://43.58.5.248:5432/police_analysis_db", table="zhaoqing_duanzhou_db.gd_place", properties={'user': 'postgres', 'password': 'postgres'})
    df.write.csv



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,6002,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6058,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,6000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6060,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,5000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,7000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,4000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,5000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,7000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,8000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,5000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,6060,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,7000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,5000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6030,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,



a,6001,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,6059,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,

a,6030,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,
b,7000,,,,22092731691889,,,,,,,,,,,52600000400005,220927316919625,